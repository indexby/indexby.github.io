!function(e){function t(t){for(var a,i,c=t[0],l=t[1],u=t[2],s=0,f=[];s<c.length;s++)i=c[s],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&f.push(o[i][0]),o[i]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(d&&d(t);f.length;)f.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,c=1;c<n.length;c++){var l=n[c];0!==o[l]&&(a=!1)}a&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},o={4:0},r=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var c=window.webpackJsonp=window.webpackJsonp||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var d=l;r.push([138,0,1]),n()}({138:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=a(n(22)),r=a(n(0)),i=n(139),c=document.getElementById("root");o.default.render(r.default.createElement(i.PageInfoMap,null),c)},139:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PageInfoMap=void 0;var o=a(n(0)),r=n(140);t.PageInfoMap=function(){var e=o.default.useState("y"),t=(e[0],e[1]);return o.default.useEffect((function(){var e=new URL(window.location.href).searchParams.get("m");e&&t(e)}),[]),o.default.createElement(r.LeafletInfoMap,null)}},140:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LeafletInfoMap=void 0;var o=a(n(0)),r=a(n(75));n(76),n(77),n(78);var i=r.default.tileLayer,c=r.default.map,l=r.default.MarkerClusterGroup,u=r.default.marker,d=r.default.DivIcon,s="1292036998:AAFkWJVt6GuU3-pyreWE-Xa8LMp4y9d0WgE",f=a(n(70)),m=n(62),p={apiKey:"AIzaSyASovzT2akPQV_-wkyLwc2d6WquAySjBio",authDomain:"census-auth.firebaseapp.com",projectId:"census-auth",storageBucket:"census-auth.appspot.com",messagingSenderId:"84703248098",appId:"1:84703248098:web:05c8d9c32e8fea83b7a8bb"},v=f.default.initializeApp(p).analytics(),g=(0,m.getNickName)();(g&&~g.indexOf("shappoff")||"localhost"===location.hostname)&&v.setAnalyticsCollectionEnabled(!1);var h=n(79)("1SQITOMPJN","2f1a6c924bc9f33235bb98e570053a79"),b=c(document.getElementById("map"),{zoomControl:!1});t.LeafletInfoMap=function(){var e=o.default.useState([]),t=e[0],n=e[1],a=o.default.useState([]),c=a[0],f=a[1],p=o.default.useState({}),g=p[0],y=p[1],_=o.default.useState(),E=_[0],k=_[1],x=o.default.useState(),C=x[0],w=x[1],M=o.default.useState(),L=M[0],T=M[1];return o.default.useEffect((function(){var e=(0,m.getNickName)();v.logEvent("page_view",{page:"Map Page",nickname:e,page_view_data:"Map Page: ".concat(e)}),document.querySelector(".leaflet-bottom.leaflet-right").innerHTML="",b.setView([54.339248,29.39981],8);var t=r.default.layerGroup();i("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:10}).addTo(t),i("https://raw.githubusercontent.com/indexby/storage/rkka_v4_and_2v_jan20/tiles/Z{z}/{y}/{x}.jpg",{minZoom:11,maxZoom:14}).addTo(t);var n=i("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:14}),a=(i("https://raw.githubusercontent.com/indexby/storage/rkka_v4_and_2v_jan20/tiles/Z{z}/{y}/{x}.jpg",{maxZoom:14}),i("https://raw.githubusercontent.com/indexby/storage/pgm_vekzhg/tiles/Z{z}/{y}/{x}.jpg",{maxZoom:14})),o=i("https://raw.githubusercontent.com/indexby/storage/3v_jun20/tiles/Z{z}/{y}/{x}.jpg",{maxZoom:13}),c=i("https://raw.githubusercontent.com/indexby/storage/3v_jan20/tiles/Z{z}/{y}/{x}.jpg",{maxZoom:13}),l=i("https://raw.githubusercontent.com/indexby/storage/rkka_v4/tiles/Z{z}/{y}/{x}.jpg",{maxZoom:14}),u=(r.default.tileLayer("http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}),r.default.tileLayer("http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}));t.addTo(b);var d={OSM:n,"OSM + РККА":t,"ПГМ":a,"3-верстка (1)":o,"3-верстка (2)":c,"РККА":l,"Гугл Спутник":u};r.default.control.layers(d,{},{position:"topleft",collapsed:!1}).addTo(b),r.default.control.zoom({position:"bottomleft"}).addTo(b),h.initIndex("censuslocations").search("",{filters:"_tags:no_geoloc"}).then((function(e){var t=e.hits;f(t)}))}),[]),o.default.useEffect((function(){h.initIndex("censuslocations").search("",{facets:["*"],filters:"_tags:geoloc",facetFilters:[[E?"region:".concat(E):""],[C?"area:".concat(C):""],[L?"selsovet:".concat(L):""]]}).then((function(e){var t=e.hits,a=e.facets;n(t),y(a)}))}),[E,C,L]),o.default.useEffect((function(){if(t&&(!t||t.length)){var e=new l({spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,animate:!0,maxClusterRadius:20,removeOutsideVisibleBounds:!0});return t.forEach((function(t){var n=t.title,a=t._geoloc,o=t.stats,i=t.selsovet,c=t.area,l=t.region,f=[];for(var m in o)o[m],f.push({year:m,count:o[m]});if(a.lat){var p=a.lat,v=a.lng,g=u([p,v],{title:"".concat(c," р-н, ").concat(i," c/c"),icon:new d({html:"<b>".concat(n,"</b>"),className:"marker-div-icon"})}),h=document.createElement("div"),y=document.createElement("b");y.innerText=n,h.appendChild(y),f.forEach((function(e,t){var n=document.createElement("div");n.innerText="".concat(e.year," год: ").concat(e.count," фамилий"),n.setAttribute("key",t.toString()),h.appendChild(n)}));var _=document.createElement("i");_.innerText="Всего записей: ".concat(f.reduce((function(e,t){return e+t.count}),0)),h.appendChild(_);var E=document.createElement("div");E.innerText="сменить",E.setAttribute("title","Сменить или уточнить геолокацию"),E.classList.add("indicate-button"),E.addEventListener("click",(function(){var e=document.getElementById("map");r.default.DomUtil.addClass(e,"crosshair-cursor-enabled");var t=function(a){var o=a.latlng,u=o.lat,d=o.lng,f="change: ".concat(l,";").concat(c,";").concat(i,";\n`").concat(n,"`;\n`").concat(u,", ").concat(d,"`\n[ordaOfBy](https://orda.of.by/.map/?").concat(u,",").concat(d,"&m=1v/14,wig/13,wig_v2/14,wig250/14,rkka/14,rkka_v2/14,rkka250/14,rkka2km/12,3v/13,3v_tmp56/13,3v_tmp71/13,kdwr/13,nem25/14,2v/13,polv/13,austr/13)");fetch("https://api.telegram.org/bot".concat(s,"/sendMessage?chat_id=").concat("162676802","&parse_mode=").concat("Markdown","&disable_web_page_preview=").concat(!0,"&text=").concat(encodeURIComponent(f))).then((function(){r.default.DomUtil.removeClass(e,"crosshair-cursor-enabled"),b.off("click",t),alert("Координаты отправлены!")}))};setTimeout((function(){b.on("click",t),g.closePopup()}))})),h.appendChild(E),g.bindPopup(h),e.addLayer(g)}})),b.addLayer(e),b.fitBounds(e.getBounds()),function(){b.removeLayer(e)}}}),[t]),o.default.useEffect((function(){var e=r.default.control({position:"topleft"});return g&&g.region&&(e.onAdd=function(e){var t=r.default.DomUtil.create("div","info region"),n=document.createElement("select");n.addEventListener("change",(function(e){v.logEvent("select_item",{items:[{item_name:e.target.value,category:"округ"}]}),k(~e.target.value.indexOf("округ")?"":e.target.value)}));var a=document.createElement("option");for(var o in a.innerText="округ",a.setAttribute("value",""),n.appendChild(a),g.region){var i=document.createElement("option");i.innerText=o,i.setAttribute("value",o),o!==E&&1!==Object.keys(g.region).length||i.setAttribute("selected","true"),n.appendChild(i)}return t.appendChild(n),t},e.addTo(b)),function(){b.removeControl(e)}}),[g.region]),o.default.useEffect((function(){var e=r.default.control({position:"topleft"});return g&&g.area&&(e.onAdd=function(e){var t=r.default.DomUtil.create("div","info area"),n=document.createElement("select");n.addEventListener("change",(function(e){v.logEvent("select_item",{items:[{item_name:e.target.value,category:"район"}]}),w(~e.target.value.indexOf("район")?"":e.target.value)}));var a=document.createElement("option");for(var o in a.innerText="район",a.setAttribute("value",""),n.appendChild(a),g.area){var i=document.createElement("option");i.innerText=o,i.setAttribute("value",o),o!==C&&1!==Object.keys(g.area).length||i.setAttribute("selected","true"),n.appendChild(i)}return t.appendChild(n),t},e.addTo(b)),function(){b.removeControl(e)}}),[g.area]),o.default.useEffect((function(){var e=r.default.control({position:"topleft"});return g&&g.selsovet&&(e.onAdd=function(e){var t=r.default.DomUtil.create("div","info selsovet"),n=document.createElement("select");n.addEventListener("change",(function(e){v.logEvent("select_item",{items:[{item_name:e.target.value,category:"сельсовет"}]}),T(~e.target.value.indexOf("сельсовет")?"":e.target.value)}));var a=document.createElement("option");for(var o in a.innerText="сельсовет",a.setAttribute("value",""),n.appendChild(a),g.selsovet){var i=document.createElement("option");i.innerText=o,i.setAttribute("value",o),o===L&&i.setAttribute("selected","true"),n.appendChild(i)}return t.appendChild(n),t},e.addTo(b)),function(){b.removeControl(e)}}),[g.selsovet]),o.default.useEffect((function(){var e={};c.sort((function(e,t){return e.title<t.title?-1:1})).forEach((function(t){var n,a,o;e[t.region]?!e[t.region]||e[t.region][t.area]?e[t.region]&&e[t.region][t.area]&&!e[t.region][t.area][t.selsovet]?e[t.region][t.area][t.selsovet]=[t.title]:e[t.region]&&e[t.region][t.area]&&e[t.region][t.area][t.selsovet]&&e[t.region][t.area][t.selsovet].push(t.title):e[t.region][t.area]=((o={})[t.selsovet]=[t.title],o):e[t.region]=((n={})[t.area]=((a={})[t.selsovet]=[t.title],a),n)}));var t=r.default.control();return t.onAdd=function(e){return this._div=r.default.DomUtil.create("div","info-not-found-villages"),this.update(),this._div},t.update=function(t){var n=document.createElement("details");n.addEventListener("click",(function(e){var t=e.target,a=!t.parentElement.hasAttribute("open");t.classList.contains("selsovet")&&([].forEach.call(n.querySelectorAll(".okrug-list > li"),(function(e){e.contains(t)||[].forEach.call(e.querySelectorAll("[open]"),(function(e){return e.removeAttribute("open")}))})),a?(k(""),w(""),T(t.getAttribute("value"))):T(""))}));var a=document.createElement("summary");a.classList.add("root"),a.innerHTML="Список не найденных на карте н.п.",n.appendChild(a);var o=document.createElement("ul");o.classList.add("okrug-list");var i=function(t){var n=document.createElement("li"),a=document.createElement("details");a.classList.add("okrug");var i=document.createElement("summary");i.classList.add("okrug"),i.innerHTML="".concat(t," округ"),a.appendChild(i);var c=document.createElement("ul"),l=function(n){var a=document.createElement("li"),o=document.createElement("details"),i=document.createElement("summary");i.classList.add("raion"),i.innerHTML="".concat(n," район"),o.appendChild(i);var l=document.createElement("ul"),u=function(a){var o=document.createElement("li"),i=document.createElement("details"),c=document.createElement("summary");c.classList.add("selsovet"),c.setAttribute("value",a),c.innerHTML="".concat(a," с/с"),i.appendChild(c),a===L&&i.setAttribute("open",null);var u=document.createElement("ul"),d=function(o){var i=document.createElement("li"),c=document.createElement("span"),l=e[t][n][a][o];c.innerHTML="".concat(l);var d=document.createElement("span");d.innerHTML="указать",d.classList.add("indicate-button"),d.setAttribute("title","Указать геолокацию этого н.п."),d.addEventListener("click",(function(){var e=document.getElementById("map");r.default.DomUtil.addClass(e,"crosshair-cursor-enabled");var o=function(c){var u=c.latlng,d=u.lat,f=u.lng,m="new: ".concat(t,";").concat(n,";").concat(a,";\n`").concat(l,"`;\n`").concat(d,", ").concat(f,"`\n[ordaOfBy](https://orda.of.by/.map/?").concat(d,",").concat(f,"&m=1v/14,wig/13,wig_v2/14,wig250/14,rkka/14,rkka_v2/14,rkka250/14,rkka2km/12,3v/13,3v_tmp56/13,3v_tmp71/13,kdwr/13,nem25/14,2v/13,polv/13,austr/13)");fetch("https://api.telegram.org/bot".concat(s,"/sendMessage?chat_id=").concat("162676802","&parse_mode=").concat("Markdown","&disable_web_page_preview=").concat(!0,"&text=").concat(encodeURIComponent(m))).then((function(){r.default.DomUtil.removeClass(e,"crosshair-cursor-enabled"),b.off("click",o),alert("Координаты отправлены!"),i.remove()}))};setTimeout((function(){b.on("click",o)}))})),i.appendChild(c),i.appendChild(d),u.appendChild(i)};for(var f in e[t][n][a])d(f);i.appendChild(u),o.appendChild(i),l.appendChild(o)};for(var d in e[t][n])u(d);o.appendChild(l),a.appendChild(o),c.appendChild(a)};for(var u in e[t])l(u);a.appendChild(c),n.appendChild(a),o.appendChild(n)};for(var c in e)i(c);n.appendChild(o),this._div.appendChild(n)},t.addTo(b),function(){b.removeControl(t)}}),[c]),null}},62:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNickName=void 0;t.getNickName=function(e){var t="",n=((t=e||localStorage.getItem("user"))?t.split("@"):[])[0];return n||"anonymous"}}});